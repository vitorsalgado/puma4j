tasks.register("setup") {
  group "Dev"
  description "Prepare local development environment"

  println "Local Environment Setup"

  doLast {
    println "Downloading Google Java Format tool ..."

    def version = "1.11.0"
    def dir = new File("$rootProject.rootDir/tools/google-java-format")
    def destination = new File("$dir/google-java-format.jar")

    dir.mkdirs()

    new URL("https://github.com/google/google-java-format/releases/download/v$version/google-java-format-$version-all-deps.jar")
        .withInputStream { i ->
          destination.withOutputStream { it << i }
        }

    println "Copying git hooks ..."

    copy {
      from("$rootProject.rootDir/scripts/githooks/commit-msg")
      into("$rootProject.rootDir/.git/hooks")
    }

    copy {
      from("$rootProject.rootDir/scripts/githooks/pre-commit")
      into("$rootProject.rootDir/.git/hooks")
    }

    Runtime.getRuntime().exec("chmod +x .git/hooks/commit-msg")
    Runtime.getRuntime().exec("chmod +x .git/hooks/pre-commit")

    println "Done"
  }
}
